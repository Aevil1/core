#define NO_UEFI

#include "gtest/gtest.h"

#if 1
// use current optimized implementation
#include "../src/score.h"
#else
// use reference implementation
void initEmptyScoreCache() {}
#include "../src/score_reference.h"
#endif

#include "uc32.h"


TEST(TestQubicScoreFunction, ValidFixedInputOutputPairs) {
#if USE_SCORE_CACHE
    initEmptyScoreCache();
#endif
    EXPECT_EQ(1018, score(665, UC32x(15364747134528261716ULL, 6394106177235010001ULL, 6330018076090747288ULL, 97310271870983756ULL).uc32x, UC32x(894241480962893893ULL, 8972639063026146571ULL, 13006221699940980716ULL, 3775897779943202747ULL).uc32x));
    EXPECT_EQ(969, score(192, UC32x(17087099704816181942ULL, 856896397091616907ULL, 17712991762625621174ULL, 3274954082407088588ULL).uc32x, UC32x(4177988543047204199ULL, 2536396317247087532ULL, 15766705573079858302ULL, 647560611620410866ULL).uc32x));
    EXPECT_EQ(1039, score(95, UC32x(12890374348688511659ULL, 9794541535473509479ULL, 13541406078704164474ULL, 6707888118110094035ULL).uc32x, UC32x(4383416341924391392ULL, 15207945484039345074ULL, 2636433866151387944ULL, 17957751220628908559ULL).uc32x));
    EXPECT_EQ(967, score(197, UC32x(3836121019069895760ULL, 15208438753506071703ULL, 7556243954151441177ULL, 3735535608799715643ULL).uc32x, UC32x(3358757834912260167ULL, 8694809476318358271ULL, 2827449736535750668ULL, 1676539389233082623ULL).uc32x));
    EXPECT_EQ(948, score(45, UC32x(12355654454245312197ULL, 10611145025045511738ULL, 6714938600002171011ULL, 1406328964614254483ULL).uc32x, UC32x(14636266039195593112ULL, 13237224864382221886ULL, 13943050866416379987ULL, 7435248047950588748ULL).uc32x));
    EXPECT_EQ(1032, score(291, UC32x(13763240690498679610ULL, 16247996437925134054ULL, 3051794319129113270ULL, 13440598706102892137ULL).uc32x, UC32x(15340253404768233719ULL, 9908455747938172965ULL, 1723802668503898418ULL, 4878678302334373491ULL).uc32x));
    EXPECT_EQ(1031, score(910, UC32x(4001792163896875969ULL, 18171702199317442335ULL, 1076828837615832799ULL, 17507247231880120154ULL).uc32x, UC32x(5363098315111809790ULL, 469998268869012937ULL, 5949251979981709454ULL, 16200855441927935962ULL).uc32x));
    EXPECT_EQ(1003, score(603, UC32x(7228464758563448398ULL, 4011944957876311038ULL, 1374667141632400956ULL, 6626036600436749256ULL).uc32x, UC32x(10227686304452227079ULL, 11588007982474883018ULL, 10626960250730295379ULL, 6060165304688826001ULL).uc32x));
    EXPECT_EQ(987, score(613, UC32x(11950683236288556588ULL, 16012303302081131535ULL, 9896068910421708804ULL, 10229109972683271759ULL).uc32x, UC32x(2363667237015391995ULL, 3370162541295395060ULL, 3844857175223633665ULL, 4010358237157876258ULL).uc32x));
    EXPECT_EQ(995, score(956, UC32x(10718708547507964182ULL, 8122884371965193853ULL, 8573536097969117387ULL, 567964670325479148ULL).uc32x, UC32x(15451183461374127331ULL, 60915385773565850ULL, 329020327980317773ULL, 4080656274167307298ULL).uc32x));
    EXPECT_EQ(998, score(843, UC32x(17118648502491046245ULL, 18127961939972351389ULL, 585432689030884179ULL, 16992347990466513841ULL).uc32x, UC32x(8147095200516922777ULL, 17733987383976207907ULL, 13464629589315384790ULL, 11315791523284093726ULL).uc32x));
    EXPECT_EQ(1023, score(660, UC32x(10210534990479871934ULL, 11110168389498862198ULL, 5350124114781980117ULL, 13999515580024767651ULL).uc32x, UC32x(8889831837815220154ULL, 2957471602178073685ULL, 13920067082365379111ULL, 5183504651770725699ULL).uc32x));
    EXPECT_EQ(1008, score(228, UC32x(18257847336224225462ULL, 159280005381744012ULL, 15977087833492300926ULL, 6637532263718473170ULL).uc32x, UC32x(15001577006242270888ULL, 8367240334124248413ULL, 18109232089117054367ULL, 9739045898358279743ULL).uc32x));
    EXPECT_EQ(988, score(662, UC32x(16834273911001744147ULL, 7087143422512973194ULL, 13916427805331272146ULL, 12738084284980517364ULL).uc32x, UC32x(892963240371923424ULL, 6533460636482340102ULL, 16902232041478017637ULL, 3449980224710860239ULL).uc32x));
    EXPECT_EQ(997, score(727, UC32x(9455300174402031779ULL, 6142653290573836405ULL, 4217926437865238375ULL, 7386655150120899363ULL).uc32x, UC32x(336443929964201063ULL, 10194982371014963015ULL, 9358920850941549203ULL, 10026824488543821601ULL).uc32x));
    EXPECT_EQ(1001, score(432, UC32x(3071804535862105917ULL, 9306565942033209145ULL, 12495320221284032366ULL, 16924686676018646386ULL).uc32x, UC32x(16450863383601395002ULL, 13964568266905102168ULL, 18015915208934758084ULL, 2682245896372932207ULL).uc32x));
    EXPECT_EQ(984, score(587, UC32x(175908659899783068ULL, 8925359769919139418ULL, 15677366111866258971ULL, 12482871221012268307ULL).uc32x, UC32x(13634076838920150759ULL, 5565601948060584734ULL, 16099081254440962085ULL, 6671083584048997197ULL).uc32x));
    EXPECT_EQ(1004, score(906, UC32x(14891775563852495796ULL, 14513570621312087429ULL, 1126447659439578613ULL, 9233519225854618837ULL).uc32x, UC32x(462814027951624925ULL, 8707156499222450508ULL, 974491424398539268ULL, 12919344625635978263ULL).uc32x));
    EXPECT_EQ(1036, score(427, UC32x(5375848965631306601ULL, 9163271218439102952ULL, 12881160377598333631ULL, 2147617670329039937ULL).uc32x, UC32x(11850241640086629276ULL, 17676163546511432631ULL, 11414276666685283423ULL, 15385803031501727695ULL).uc32x));
    EXPECT_EQ(983, score(859, UC32x(15601935854199958703ULL, 16851131872240150984ULL, 7993299578672147301ULL, 16395040958340770631ULL).uc32x, UC32x(6191028778417398860ULL, 5197672684883950478ULL, 15376397950672745514ULL, 2870431428001030852ULL).uc32x));
    EXPECT_EQ(1009, score(733, UC32x(13570146508645705207ULL, 3564976454476729737ULL, 11087423511279505675ULL, 13007336646764962178ULL).uc32x, UC32x(2893150106592693330ULL, 5239108361525190154ULL, 9668617906542108085ULL, 517438685068057350ULL).uc32x));
    EXPECT_EQ(992, score(1021, UC32x(608052312810218826ULL, 17883120404883598880ULL, 17484655094347945938ULL, 18025964813576375727ULL).uc32x, UC32x(4210373402743133612ULL, 17420654929919812115ULL, 11202076652053835615ULL, 7434629825375556842ULL).uc32x));
    EXPECT_EQ(1003, score(13, UC32x(15944894716372456591ULL, 7457202346525928448ULL, 17896734655330297158ULL, 10905151257998561863ULL).uc32x, UC32x(10061957895747020600ULL, 1558993897563270259ULL, 16635332056091083106ULL, 1157246591654838534ULL).uc32x));
    EXPECT_EQ(1044, score(429, UC32x(5310487129651958760ULL, 5412896805845974794ULL, 1664224006917000429ULL, 4316779669001055653ULL).uc32x, UC32x(13878651201959116534ULL, 5083833583132404559ULL, 9442834604995545275ULL, 3578472306799444732ULL).uc32x));
    EXPECT_EQ(1003, score(487, UC32x(6258251576427170376ULL, 10574592319043515676ULL, 10595749591609943799ULL, 10558645065906709535ULL).uc32x, UC32x(13986137019345301007ULL, 15479488151712814242ULL, 8221094572787896455ULL, 3942984471526137621ULL).uc32x));
    EXPECT_EQ(1009, score(742, UC32x(12576744782433093617ULL, 2234564346591778584ULL, 10833088789709170610ULL, 8486216445782591915ULL).uc32x, UC32x(7844323369074407ULL, 14360796116163543486ULL, 14574814423556772900ULL, 11628974315416345035ULL).uc32x));
    EXPECT_EQ(1021, score(308, UC32x(17379646518706833598ULL, 9145107457355824915ULL, 6290441062974246611ULL, 14713409586531721896ULL).uc32x, UC32x(9010121053282669308ULL, 15740497924053879591ULL, 11731292687129361516ULL, 13084233355374821807ULL).uc32x));
    EXPECT_EQ(994, score(285, UC32x(6742028881233216433ULL, 7370397245643823123ULL, 1902529371182020281ULL, 5590058342249730268ULL).uc32x, UC32x(13945769531078265814ULL, 4856126732242510202ULL, 15280034125101839326ULL, 15383501140928182705ULL).uc32x));
    EXPECT_EQ(1018, score(290, UC32x(18293043402759431669ULL, 6608206220177972031ULL, 1961597035362509808ULL, 11951471429589558797ULL).uc32x, UC32x(7242043271117895535ULL, 10488038299943423223ULL, 4009571053108942629ULL, 10284702693981037411ULL).uc32x));
    EXPECT_EQ(1012, score(288, UC32x(858349533526113444ULL, 1977212676570788001ULL, 10448421431077454736ULL, 7801370405694576928ULL).uc32x, UC32x(13825688107456201851ULL, 7154244762005970447ULL, 1729282082646144738ULL, 7488383165802609314ULL).uc32x));
    EXPECT_EQ(1001, score(351, UC32x(18034528363151317003ULL, 3793081922628317369ULL, 15887846583993028559ULL, 7893750447199079983ULL).uc32x, UC32x(17294405982089305069ULL, 895108834280459496ULL, 3334973041988873691ULL, 5088013839510764664ULL).uc32x));
    EXPECT_EQ(1015, score(475, UC32x(9363980303204292013ULL, 3169528938831866373ULL, 21540456795426771ULL, 7771620790870324792ULL).uc32x, UC32x(15729323073237254425ULL, 10721975374371469596ULL, 1257440800722544716ULL, 11306282793014721955ULL).uc32x));
    EXPECT_EQ(967, score(538, UC32x(17006918383638801696ULL, 11391679576905665814ULL, 8112518894390390574ULL, 17195127300379619800ULL).uc32x, UC32x(1726972717044081078ULL, 2364735962515035050ULL, 15581744152439104398ULL, 6094461529156423357ULL).uc32x));
    EXPECT_EQ(1020, score(955, UC32x(835076686781116885ULL, 15756889797033258866ULL, 18371616044904481192ULL, 7687014892470055645ULL).uc32x, UC32x(14981525464633036261ULL, 14794906651287014612ULL, 10893458209471390643ULL, 13294306360393501526ULL).uc32x));
    EXPECT_EQ(1023, score(761, UC32x(3514903714619535883ULL, 10004913546917435820ULL, 2328693042637623728ULL, 1183464814478590229ULL).uc32x, UC32x(2612683340967271652ULL, 16139761398771075785ULL, 1326185071504793351ULL, 18421588237153372203ULL).uc32x));
    EXPECT_EQ(1009, score(921, UC32x(15029145355728185837ULL, 15195483387473640111ULL, 6696206032961620309ULL, 3679101327156906254ULL).uc32x, UC32x(992959102195108779ULL, 5549511864529274820ULL, 12807490261020810442ULL, 637444441231176272ULL).uc32x));
    EXPECT_EQ(982, score(574, UC32x(6920766332121508446ULL, 126362945231631442ULL, 11801182876810823253ULL, 4665553050619545503ULL).uc32x, UC32x(18203848873640441881ULL, 17142174630320008899ULL, 16806501275253371807ULL, 4942262897761205181ULL).uc32x));
    EXPECT_EQ(998, score(13, UC32x(7417527241155030889ULL, 1844644835211884635ULL, 16931011593820966851ULL, 12519427756924730753ULL).uc32x, UC32x(2192023150594013052ULL, 5610769342821425359ULL, 2861500445944969294ULL, 12691469143280363572ULL).uc32x));
    EXPECT_EQ(986, score(378, UC32x(12407022607406003848ULL, 12573819981406797323ULL, 12652617424220091671ULL, 6613594241492800143ULL).uc32x, UC32x(7181959998880508805ULL, 9835376706172218077ULL, 18262880499319519781ULL, 9741687745603928769ULL).uc32x));
    EXPECT_EQ(1021, score(781, UC32x(8177999016773233318ULL, 786729331532776470ULL, 7674806080976726707ULL, 6301780979939839423ULL).uc32x, UC32x(11203721632768558531ULL, 5022887984680230906ULL, 8603599514202796141ULL, 12211046686286460679ULL).uc32x));
    EXPECT_EQ(995, score(92, UC32x(14199309513771786636ULL, 15469937146353782894ULL, 15529288615881211422ULL, 1774706963907113547ULL).uc32x, UC32x(14820782983786661886ULL, 13523353093000052456ULL, 352135413836398119ULL, 668104666457072337ULL).uc32x));
    EXPECT_EQ(984, score(542, UC32x(15109348856731832102ULL, 3077372724614183219ULL, 1440452367038975344ULL, 5397396373642713152ULL).uc32x, UC32x(13898100352941384491ULL, 2036078386313709812ULL, 7775462861287054415ULL, 174376609793395564ULL).uc32x));
    EXPECT_EQ(971, score(544, UC32x(11451109503839463178ULL, 6543784509938100703ULL, 15029577061471949808ULL, 3787963840392628790ULL).uc32x, UC32x(1816163869608522450ULL, 16594274908086206795ULL, 14140936312884814076ULL, 7100062594041428596ULL).uc32x));
    EXPECT_EQ(998, score(832, UC32x(561079570829543319ULL, 5239474996599025152ULL, 16735569464658828333ULL, 10697434722356023774ULL).uc32x, UC32x(325127538162793460ULL, 13738710276647200209ULL, 15937242828532073888ULL, 2564495526576944479ULL).uc32x));
    EXPECT_EQ(1030, score(387, UC32x(10805101383306986413ULL, 10569053102253339054ULL, 1094880380747387068ULL, 12780363694067652146ULL).uc32x, UC32x(7028529061148701508ULL, 13977272820604619901ULL, 1181125693874776898ULL, 9886539437552794439ULL).uc32x));
    EXPECT_EQ(1014, score(559, UC32x(17891662586521118843ULL, 18154874876331648736ULL, 4943076430946044778ULL, 13332175845907919819ULL).uc32x, UC32x(18294664092805154357ULL, 16437736056638950139ULL, 6780187778212354068ULL, 15076791114298070436ULL).uc32x));
    EXPECT_EQ(991, score(46, UC32x(13622829375090273133ULL, 8700268102193983848ULL, 11929806805117558592ULL, 8996652736641009632ULL).uc32x, UC32x(14612028753125014733ULL, 12906562248762901438ULL, 7959232326473616203ULL, 3717752546153904244ULL).uc32x));
    EXPECT_EQ(970, score(600, UC32x(3976912778058669188ULL, 10076921104177215797ULL, 10856830686512720726ULL, 17512862525632491851ULL).uc32x, UC32x(17800324910966012584ULL, 761600828740477085ULL, 8510235085853973211ULL, 9667213743034795425ULL).uc32x));
    EXPECT_EQ(1005, score(56, UC32x(6331213416402395985ULL, 17860818148326515964ULL, 10223115564155074685ULL, 6858050886228545407ULL).uc32x, UC32x(15052566638189279610ULL, 5391634706522432256ULL, 7609675712667611997ULL, 9866880642800790056ULL).uc32x));
    EXPECT_EQ(971, score(201, UC32x(17836466215901212677ULL, 865027031675014750ULL, 10542747835277455127ULL, 7695360408796027115ULL).uc32x, UC32x(644164803059507538ULL, 6671223818464946128ULL, 7997972377232211239ULL, 8775465766078253402ULL).uc32x));
    EXPECT_EQ(985, score(891, UC32x(2496021014900215978ULL, 4438761778791646867ULL, 17794884597810861404ULL, 13787814659358618426ULL).uc32x, UC32x(11064513438797496432ULL, 17854451512406141006ULL, 3204162557744577224ULL, 922408669928970176ULL).uc32x));
    EXPECT_EQ(1003, score(349, UC32x(17489343180227325403ULL, 1377250897738816286ULL, 2321716371851791108ULL, 9160092646129347246ULL).uc32x, UC32x(9100524958816217292ULL, 2126520649556230919ULL, 9683716621629358925ULL, 14553512724772609027ULL).uc32x));
    EXPECT_EQ(1007, score(787, UC32x(5620036605033159409ULL, 12008993601119521757ULL, 14368832961290620485ULL, 7477383827142512283ULL).uc32x, UC32x(4449988088343324913ULL, 5221077055071298723ULL, 17131463986754130129ULL, 15400983175290458619ULL).uc32x));
    EXPECT_EQ(1015, score(592, UC32x(15182400179153415874ULL, 6024694553259812708ULL, 8345250941303660495ULL, 1227866703606207335ULL).uc32x, UC32x(4368540041001983353ULL, 12992183845238729949ULL, 6274721519685780237ULL, 1117591322092600159ULL).uc32x));
    EXPECT_EQ(987, score(917, UC32x(7050344377025566752ULL, 7881208099996063420ULL, 2239714253951252973ULL, 16491483652707091514ULL).uc32x, UC32x(2568825523303944737ULL, 5783145148688399593ULL, 6638627872629917500ULL, 12269563984748702788ULL).uc32x));
    EXPECT_EQ(996, score(272, UC32x(1849509410595912156ULL, 15721236657153592436ULL, 13528967170194785736ULL, 15129485560963562310ULL).uc32x, UC32x(8022560051671076379ULL, 4771838960849757180ULL, 1094940875893385145ULL, 15301032946041963415ULL).uc32x));
    EXPECT_EQ(993, score(219, UC32x(2020288915194096502ULL, 15680496715536783566ULL, 1033424388592133424ULL, 3937297032884957432ULL).uc32x, UC32x(15021844034660333533ULL, 6353767520908432605ULL, 6105613828560912630ULL, 17874297888503913970ULL).uc32x));
    EXPECT_EQ(984, score(823, UC32x(17832538127318877343ULL, 3018443081279858669ULL, 13604363873374357998ULL, 16023270285221665452ULL).uc32x, UC32x(11286374657504580331ULL, 11515450722859914697ULL, 12542669259406687376ULL, 1873518422959228112ULL).uc32x));
    EXPECT_EQ(1017, score(793, UC32x(2049613872015806934ULL, 7909443966898109945ULL, 2756550071516190138ULL, 10638937564180116418ULL).uc32x, UC32x(15560843604903831161ULL, 4220996302529536681ULL, 6379694644422952727ULL, 13519430688722641765ULL).uc32x));
    EXPECT_EQ(990, score(692, UC32x(13639937501933364289ULL, 17097773619038088932ULL, 15317178289621976760ULL, 10938037214608751863ULL).uc32x, UC32x(10813389895437612173ULL, 3240225729852522984ULL, 13989339307898487985ULL, 9360215186703928227ULL).uc32x));
}
